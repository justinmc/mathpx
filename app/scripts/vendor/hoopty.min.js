/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

!function(t,e){t.hoopty=e()}(this,function(){var t,e,i;return function(n){function o(t,e){return b.call(t,e)}function s(t,e){var i,n,o,s,r,h,p,c,l,a,u,y=e&&e.split("/"),d=x.map,f=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(y=y.slice(0,y.length-1),t=t.split("/"),r=t.length-1,x.nodeIdCompat&&w.test(t[r])&&(t[r]=t[r].replace(w,"")),t=y.concat(t),l=0;l<t.length;l+=1)if(u=t[l],"."===u)t.splice(l,1),l-=1;else if(".."===u){if(1===l&&(".."===t[2]||".."===t[0]))break;l>0&&(t.splice(l-1,2),l-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((y||f)&&d){for(i=t.split("/"),l=i.length;l>0;l-=1){if(n=i.slice(0,l).join("/"),y)for(a=y.length;a>0;a-=1)if(o=d[y.slice(0,a).join("/")],o&&(o=o[n])){s=o,h=l;break}if(s)break;!p&&f&&f[n]&&(p=f[n],c=l)}!s&&p&&(s=p,h=c),s&&(i.splice(0,h,s),t=i.join("/"))}return t}function r(t,e){return function(){return y.apply(n,A.call(arguments,0).concat([t,e]))}}function h(t){return function(e){return s(e,t)}}function p(t){return function(e){g[t]=e}}function c(t){if(o(m,t)){var e=m[t];delete m[t],v[t]=!0,u.apply(n,e)}if(!o(g,t)&&!o(v,t))throw new Error("No "+t);return g[t]}function l(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function a(t){return function(){return x&&x.config&&x.config[t]||{}}}var u,y,d,f,g={},m={},x={},v={},b=Object.prototype.hasOwnProperty,A=[].slice,w=/\.js$/;d=function(t,e){var i,n=l(t),o=n[0];return t=n[1],o&&(o=s(o,e),i=c(o)),o?t=i&&i.normalize?i.normalize(t,h(e)):s(t,e):(t=s(t,e),n=l(t),o=n[0],t=n[1],o&&(i=c(o))),{f:o?o+"!"+t:t,n:t,pr:o,p:i}},f={require:function(t){return r(t)},exports:function(t){var e=g[t];return"undefined"!=typeof e?e:g[t]={}},module:function(t){return{id:t,uri:"",exports:g[t],config:a(t)}}},u=function(t,e,i,s){var h,l,a,u,y,x,b=[],A=typeof i;if(s=s||t,"undefined"===A||"function"===A){for(e=!e.length&&i.length?["require","exports","module"]:e,y=0;y<e.length;y+=1)if(u=d(e[y],s),l=u.f,"require"===l)b[y]=f.require(t);else if("exports"===l)b[y]=f.exports(t),x=!0;else if("module"===l)h=b[y]=f.module(t);else if(o(g,l)||o(m,l)||o(v,l))b[y]=c(l);else{if(!u.p)throw new Error(t+" missing "+l);u.p.load(u.n,r(s,!0),p(l),{}),b[y]=g[l]}a=i?i.apply(g[t],b):void 0,t&&(h&&h.exports!==n&&h.exports!==g[t]?g[t]=h.exports:a===n&&x||(g[t]=a))}else t&&(g[t]=i)},t=e=y=function(t,e,i,o,s){if("string"==typeof t)return f[t]?f[t](e):c(d(t,e).f);if(!t.splice){if(x=t,x.deps&&y(x.deps,x.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=o,o=s),o?u(n,t,e,i):setTimeout(function(){u(n,t,e,i)},4),y},y.config=function(t){return y(t)},t._defined=g,i=function(t,e,i){e.splice||(i=e,e=[]),o(g,t)||o(m,t)||(m[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("../bower_components/almond/almond",function(){}),i("extendable",[],function(){return function(){function t(){}return t.extend=function(t){function e(){this.constructor=t}for(var i in this)t.prototype.hasOwnProperty(i)||(t[i]=this[i]);e.prototype=this.prototype,t.prototype=new e,t.__super__=this.prototype},t}()}),i("scene",["extendable"],function(t){return function(){function e(t){this.engine=t,this.entities=[]}return t.extend(e),e.prototype.route="/",e.prototype.entities=[],e.prototype.engine=null,e.prototype.dragging=!1,e.prototype.render=function(t,e){this.ctx=t;var i=this;this.entities.forEach(function(n){n.display&&(i.eventFire({type:"preRender",dt:e}),n.render(t,e))})},e.prototype.entityAdd=function(t){return this.entities.push(t),this.entities[this.entities.length-1]},e.prototype.entityRemove=function(t){for(var e in this.entities){var i=this.entities[e];if(i===t)return this.entities.splice(e,1),!0}return!1},e.prototype.eventFire=function(t){t.type in this&&this[t.type](t);for(var e=this.entities.length-1;e>=0;e--){var i=this.entities[e];t.type in i&&i[t.type](t,this);for(var n in i.components){var o=i.components[n];t.type in o&&o[t.type](t,this)}}},e.prototype.getEventCoords=function(t){if("ctx"in this){var e=0,i=0,n=0,o=0,s=this.ctx.canvas,r=0,h=0;if("touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type||"touchcancel"===t.type){var p=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];r=p.pageX,h=p.pageY}else r=t.pageX,h=t.pageY;do e+=s.offsetLeft-s.scrollLeft,i+=s.offsetTop-s.scrollTop;while(s=s.offsetParent);n=r-e,o=h-i;var c=this.ctx.canvas.width/this.ctx.canvas.style.width.substr(0,this.ctx.canvas.style.width.length-2);return n*=c,o*=c,{x:n,y:o}}return{x:0,y:0}},e.isInside=function(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height?!0:!1},e.isOverlap=function(t,e){var i=t.x,n=t.x+t.width,o=t.y,s=t.y+t.height,r=e.x,h=e.x+e.width,p=e.y,c=e.y+e.height;return h>i&&n>r&&c>o&&s>p?!0:!1},e.getMidpoint=function(t,e){var i={x:0,y:0};return i.x=Math.round((t.x+e.x)/2),i.y=Math.round((t.y+e.y)/2),i},e.prototype.reset=function(){this.engine.scenes[this.name]=new e(this.engine),this.engine.changeScenes(this.name)},e.prototype.destroy=function(){this.engine.sceneDestroy(this.name)},e}()}),i("engine",["scene"],function(){return function(){function t(e,i){null!==i&&(this.changeScenesCallback=i),t.prototype.scenes={},this.canvas=e,this.ctx=this.canvas.getContext("2d");var n=this;this.canvas.addEventListener("mousedown",function(t){n.getSceneActive().eventFire(t)}),this.canvas.addEventListener("mousemove",function(t){n.getSceneActive().eventFire(t)}),this.canvas.addEventListener("mouseup",function(t){n.getSceneActive().eventFire(t)}),this.canvas.addEventListener("click",function(t){n.getSceneActive().eventFire(t)}),this.canvas.addEventListener("touchstart",function(t){n.getSceneActive().eventFire(t)}),this.canvas.addEventListener("touchmove",function(t){n.getSceneActive().eventFire(t)}),this.canvas.addEventListener("touchend",function(t){n.getSceneActive().eventFire(t)}),document.addEventListener("keyup",function(t){n.getSceneActive().eventFire(t)})}return t.prototype.canvas=null,t.prototype.ctx=null,t.prototype.scenes={},t.prototype.sceneActive=null,t.prototype.changeScenesCallback=null,t.prototype.sceneChanging=!1,t.prototype.render=function(t){this.getSceneActive().render(this.ctx,t)},t.prototype.sceneAdd=function(t,e){this.scenes[e]=t,this.scenes[e].name=e},t.prototype.sceneDestroy=function(t){delete this.scenes[t]},t.prototype.getSceneActive=function(){return this.scenes[this.sceneActive]},t.prototype.changeScenes=function(t,e,i){if(null!==t&&t!==this.sceneActive&&!this.sceneChanging){var n=this.sceneActive;if(this.scenes.hasOwnProperty(t)||null===e||this.sceneAdd(new e(this),t),this.scenes.hasOwnProperty(t)){this.sceneChanging=!0;var o=this;window.setTimeout(function(){o.sceneActive=t,null!==i&&i||null===n||o.scenes[n].destroy(),null!==o.changeScenesCallback&&o.changeScenesCallback(o.getSceneActive()),o.sceneChanging=!1},50)}}},t}()}),i("entity",["extendable"],function(t){return function(){function e(t,e,i,n,o){this.x=t,this.y=e,this.width=i,this.height=n,null!==o&&(this.color=o),this.components={}}return t.extend(e),e.prototype.display=!0,e.prototype.x=0,e.prototype.y=0,e.prototype.width=0,e.prototype.height=0,e.prototype.color="rgb(0, 0, 0)",e.prototype.components={},e.prototype.render=function(t){t.fillStyle=this.color,t.fillRect(this.x,this.y,this.width,this.height)},e.prototype.componentAdd=function(t){this.components[t.name]=t},e.prototype.componentRemove=function(t){delete this.components[t.name]},e}()}),i("sprite",["entity"],function(t){return function(){function e(t,i,n,o,s,r,h,p,c){e.__super__.constructor.call(this,t,i,n,o),this.spriteSheet=s,this.spriteX=r,this.spriteY=h,this.spriteHeight=c,this.spriteWidth=p,this.spriteXDefault=r,this.spriteYDefault=h,this.obj=new Image;var l=this;this.obj.addEventListener("load",function(){l.loading=!1},!1),this.obj.src=this.spriteSheet,this.loading=!0,this.spriteAnimations={}}return t.extend(e),e.prototype.obj=null,e.prototype.spriteSheet=null,e.prototype.spriteX=0,e.prototype.spriteY=0,e.prototype.spriteXDefault=0,e.prototype.spriteYDefault=0,e.prototype.loading=!1,e.prototype.spriteAnimations={},e.prototype.spriteAnimation=null,e.prototype.spriteAnimationTime=null,e.prototype.spriteAnimationCallback=null,e.prototype.render=function(t,e){if(!this.loading){if(null!==this.spriteAnimation){this.spriteAnimationTime+=e;var i=this.spriteAnimations[this.spriteAnimation],n=i.toX-i.fromX+1;if(this.spriteAnimationTime>i.period*n)this.spriteAnimationRepetitions>0?(this.spriteAnimationRepetitions--,0===this.spriteAnimationRepetitions?(null!==this.spriteAnimationCallback&&this.spriteAnimationCallback({type:"spriteAnimationEnd"},this),this.spriteAnimation=null,this.spriteAnimationTime=null,this.spriteAnimationCallback=null,this.spriteX=this.spriteXDefault,this.spriteY=this.spriteYDefault):this.spriteAnimationTime=0):this.spriteAnimationTime=0;else{var o=Math.floor(this.spriteAnimationTime/i.period);this.spriteX=i.fromX+o,this.spriteY=i.fromY}}if(this.display){var s=this.obj,r=this.spriteX*this.spriteWidth,h=this.spriteY*this.spriteHeight,p=this.spriteWidth,c=this.spriteHeight,l=this.x,a=this.y,u=this.width,y=this.height;t.drawImage(s,r,h,p,c,l,a,u,y)}}},e.prototype.spriteAnimationAdd=function(t,e,i,n,o){this.spriteAnimations[t]={fromX:e,fromY:i,toX:n,period:o}},e.prototype.spriteAnimate=function(t,e,i){"undefined"!=typeof i&&(this.spriteAnimationCallback=i),null===e&&(e=-1),this.spriteAnimationRepetitions=e,this.spriteAnimation=t,this.spriteAnimationTime=0},e.prototype.spriteAnimateStop=function(){this.spriteAnimation=null,this.spriteAnimationTime=null,this.spriteX=this.spriteXDefault,this.spriteY=this.spriteYDefault},e}()}),i("text",["entity"],function(t){return function(){function e(t,i,n,o,s,r){"undefined"!=typeof o&&(this.text=o),"undefined"!=typeof s&&(this.font=s),"undefined"!=typeof r&&(this.fillStyle=r),e.__super__.constructor.call(this,t,i,n,0)}return t.extend(e),e.prototype.text="",e.prototype.font=null,e.prototype.fillStyle="rgb(0, 0, 0)",e.prototype.render=function(t){null!==this.font&&(t.font=this.font),t.fillStyle=this.fillStyle,t.fillText(this.text,this.x,this.y,this.width)},e}()}),i("textMultiline",["text"],function(t){return function(){function e(t,i,n,o,s,r,h,p){e.__super__.constructor.call(this,t,i,n,o,s,r),"undefined"!=typeof h&&(this.charsPerLine=h),"undefined"!=typeof p&&(this.lineHeight=p);for(var c=this.text.split(" "),l=0;c.length;){for(this.textArray[l]=c.shift();this.textArray[l]&&"undefined"!=typeof c[0]&&(this.textArray[l]+c[0]).length<this.charsPerLine;)this.textArray[l]+=" "+c.shift();l++}}return t.extend(e),e.prototype.charsPerLine=80,e.prototype.lineHeight=30,e.prototype.textArray=[],e.prototype.render=function(t){null!==this.font&&(t.font=this.font),t.fillStyle=this.fillStyle;for(var e=0;e<this.textArray.length;e++)t.fillText(this.textArray[e],this.x,this.y+e*this.lineHeight,this.width)},e}()}),i("button",["scene","text"],function(t,e){return function(){function i(t,e,n,o,s,r,h,p,c,l){i.__super__.constructor.call(this,t,e,n,s,r,h),this.callback=p,this.height=o,"undefined"!=typeof c&&(this.padding=c),"undefined"!=typeof l&&(this.strokeStyle=l)}return e.extend(i),i.prototype.callback=null,i.prototype.scene=null,i.prototype.height=null,i.prototype.padding=16,i.prototype.strokeStyle="rgb(0, 0, 0)",i.prototype.render=function(t){t.strokeStyle=this.strokeStyle,t.strokeRect(this.x,this.y,this.width,this.height),null!==this.font&&(t.font=this.font),t.fillStyle=this.fillStyle,t.fillText(this.text,this.x+this.padding,this.y+2*this.height/3,this.width-2*this.padding)},i.prototype.click=function(e,i){t.isInside(i.getEventCoords(e),this)&&this.display&&this.callback(e)},i}()}),i("component",["extendable"],function(t){return function(){function e(t){this.entity=t}return t.extend(e),e.prototype.entity={},e.prototype.name="Component",e.prototype.respondEvents={},e}()}),i("tween",["component"],function(t){return function(){function e(t,i,n,o,s){this.x=i,this.y=n,"undefined"!=typeof s&&(this.callback=s),this.x0=t.x,this.y0=t.y;var r=Math.pow(Math.pow(n-t.y,2)+Math.pow(i-t.x,2),.5);null!==o&&(this.duration=r/o),this.mx=(i-t.x)/this.duration,this.my=(n-t.y)/this.duration,e.__super__.constructor.call(this,t)}return t.extend(e),e.prototype.name="Tween",e.prototype.x=null,e.prototype.y=null,e.prototype.callback=null,e.prototype.x0=null,e.prototype.y0=null,e.prototype.time=0,e.prototype.duration=null,e.prototype.mx=null,e.prototype.my=null,e.prototype.preRender=function(t){null!==this.time&&this.time<this.duration&&(this.time+=t.dt,this.time>=this.duration?(this.entity.x=this.x,this.entity.y=this.y,this.time=null,null!==this.callback&&this.callback(t,this.entity)):(this.entity.x=this.x0+this.mx*this.time,this.entity.y=this.y0+this.my*this.time))},e}()}),i("draggable",["scene","component"],function(t,e){return function(){function i(t){i.__super__.constructor.call(this,t)}return e.extend(i),i.prototype.name="Draggable",i.prototype.draggingX=null,i.prototype.draggingY=null,i.prototype.mousedown=function(t,e){this.dragStart(t,e)},i.prototype.touchstart=function(t,e){this.dragStart(t,e)},i.prototype.mousemove=function(t,e){this.dragMove(t,e)},i.prototype.touchmove=function(t,e){this.dragMove(t,e)},i.prototype.mouseup=function(t,e){this.dragEnd(t,e)},i.prototype.touchend=function(t,e){this.dragEnd(t,e)},i.prototype.dragStart=function(e,i){if(i.dragging===!1){var n=i.getEventCoords(e);t.isInside(n,this.entity)&&(i.dragging=!0,this.draggingX=n.x-this.entity.x,this.draggingY=n.y-this.entity.y)}},i.prototype.dragMove=function(t,e){if(null!==this.draggingX&&null!==this.draggingY){var i=e.getEventCoords(t);this.entity.x=i.x-this.draggingX,this.entity.y=i.y-this.draggingY}},i.prototype.dragEnd=function(t,e){if(null!==this.draggingX&&null!==this.draggingY){e.dragging=!1;var i=e.getEventCoords(t);this.entity.x=i.x-this.draggingX,this.entity.y=i.y-this.draggingY,this.draggingX=null,this.draggingY=null}},i}()}),i("dragCreate",["scene","component"],function(t,e){return function(){function i(t,e,n){this.EntityDragBind=e,"undefined"!=typeof n&&(this.callback=n),i.__super__.constructor.call(this,t)}return e.extend(i),i.prototype.name="DragCreate",i.prototype.EntityDragBind=null,i.prototype.callback=null,i.prototype.touchstart=function(t,e){this.drag(t,e)},i.prototype.mousedown=function(t,e){this.drag(t,e)},i.prototype.drag=function(e,i){if(this.entity.display&&!i.dragging){var n=i.getEventCoords(e);if(t.isInside(n,this.entity)){var o=i.entityAdd(new this.EntityDragBind);o.x=this.entity.x,o.y=this.entity.y,o.components.Draggable.draggingX=n.x-this.entity.x,o.components.Draggable.draggingY=n.y-this.entity.y,null!==this.callback&&this.callback(e,i,this.entity,o)}}},i}()}),i("bounded",["component"],function(t){return function(){function e(t,i,n,o,s){null!==i&&(this.x=i),null!==n&&(this.y=n),null!==o&&(this.width=o),null!==s&&(this.height=s),e.__super__.constructor.call(this,t)}return t.extend(e),e.prototype.name="Bounded",e.prototype.x=null,e.prototype.y=null,e.prototype.width=null,e.prototype.height=null,e.prototype.preRender=function(t,e){null===this.x&&(this.x=0),null===this.y&&(this.y=0),null===this.width&&(this.width=e.ctx.canvas.width),null===this.height&&(this.height=e.ctx.canvas.height),this.entity.y<this.y&&(this.entity.y=this.y),this.entity.x+this.entity.width>this.x+this.width&&(this.entity.x=this.x+this.width-this.entity.width),this.entity.y+this.entity.height>this.y+this.height&&(this.entity.y=this.height-this.y-this.entity.height),this.entity.x<this.x&&(this.entity.x=this.x)},e}()}),i("collision",["scene","component"],function(t,e){return function(){function i(t,e,n,o){this.entity=t,this.componentCollidable=e,this.callback=n,null!==o&&(this.eventName=o),i.__super__.constructor.call(this,t)}return e.extend(i),i.prototype.name="Collision",i.prototype.callback=null,i.prototype.eventName="preRender",i.prototype.componentCollidable=null,i.prototype.preRender=function(t,e){this.eventName===t.type&&this.check(t,e)},i.prototype.mouseup=function(t,e){this.eventName===t.type&&this.check(t,e)},i.prototype.mousedown=function(t,e){this.eventName===t.type&&this.check(t,e)},i.prototype.mousemove=function(t,e){this.eventName===t.type&&this.check(t,e)},i.prototype.check=function(e,i){if(this.entity.display)for(var n in i.entities){var o=i.entities[n];this.entity!==o&&o.display&&(null===this.componentCollidable||this.componentCollidable in o.components)&&t.isOverlap(this.entity,o)&&this.callback(e,i,o)}},i}()}),i("loading",["scene","text"],function(t,e){return function(){function i(t,n,o){o&&(this.sceneNameChangeTo=o),i.__super__.constructor.call(this,t),n||(n=[]),this.urlCount=n.length,this.entityAdd(new e(this.engine.ctx.canvas.width/4,260,0,"Loading...","50px 'Press Start 2P'","rgb(0, 0, 0)"));var s=this;n.forEach(function(t){var e=new Image;e.addEventListener("load",function(){s.urlsDone++},!1),e.src=t})}return t.extend(i),i.prototype.name="Loading",i.prototype.sceneNameChangeTo="Start",i.prototype.urlCount=0,i.prototype.urlsDone=0,i.prototype.render=function(t,e){this.urlsDone>=this.urlCount&&this.engine.changeScenes(this.sceneNameChangeTo),t.fillStyle="rgb(255, 255, 255)",t.fillRect(0,0,t.canvas.width,t.canvas.height),i.__super__.render.call(this,t,e)},i}()}),e.config({paths:{loading:"scenes/loading",sprite:"entities/sprite",text:"entities/text",textMultiline:"entities/textMultiline",button:"entities/button",tween:"components/tween",draggable:"components/draggable",dragCreate:"components/dragCreate",bounded:"components/bounded",collision:"components/collision"}}),e(["engine","entity","sprite","text","textMultiline","button","component","tween","draggable","dragCreate","bounded","collision","scene","loading"],function(t,e,i,n,o,s,r,h,p,c,l,a,u,y){window.hoopty={Engine:t,entities:{Entity:e,Sprite:i,Text:n,TextMultiline:o,Button:s},components:{Component:r,Tween:h,Draggable:p,DragCreate:c,Bounded:l,Collision:a},scenes:{Scene:u,Loading:y}}}),i("main",function(){}),e("main")});